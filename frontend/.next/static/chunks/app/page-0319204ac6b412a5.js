(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4800:function(e,t,s){Promise.resolve().then(s.bind(s,3695))},3695:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var a=s(7437),l=s(2265),i=s(6706),n=s(7140),r=s(1568),o=s(5306),d=s(4341),c=s(3225),x=s(3231),m=s(6780),u=s(9162),h=s(4839),p=s(6164);function g(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,p.m6)((0,h.W)(t))}var b=s(5211),f=s(7346);b.kL.register(b.uw,b.f$,b.od,b.jn,b.Dx,b.u,b.De,b.Gu);let j="https://keeper-q2n9z.ondigitalocean.app/keeper/diagnostics";function N(){var e,t,s;let[u,h]=(0,l.useState)(null),[p,b]=(0,l.useState)(!0),[f,N]=(0,l.useState)(null),[w,E]=(0,l.useState)(!1),F=async()=>{try{b(!0);let e=await fetch(j),t=await e.json();h(t),N(null)}catch(e){N(e.message)}finally{b(!1)}},k=async()=>{if(confirm("Are you sure you want to reset all performance metrics? This will restart APY calculation from zero."))try{E(!0);let e=await fetch("https://keeper-q2n9z.ondigitalocean.app/keeper/reset-metrics",{method:"POST"}),t=await e.json();alert(t.message),await F()}catch(e){alert("Error resetting metrics: "+e.message)}finally{E(!1)}};if((0,l.useEffect)(()=>{F();let e=setInterval(F,3e4);return()=>clearInterval(e)},[]),p&&!u)return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-slate-950 text-slate-400",children:[(0,a.jsx)(i.Z,{className:"w-10 h-10 animate-spin mb-4 text-indigo-500"}),(0,a.jsx)("p",{className:"text-lg font-medium animate-pulse",children:"Loading Quant Dashboard..."})]});let P=(null==u?void 0:u.apy)||{estimated:0,realized:0,byExchange:{},expectedEarningsNextPeriod:0,historicalEarnings:[]},D=(null==u?void 0:u.positions)||{count:0,totalValue:0,unrealizedPnl:0,byExchange:{}},L=(null==u?void 0:u.health)||{overall:"UNKNOWN",issues:[]},S=(null==u?void 0:u.rewards)||{accruedProfits:0,totalHarvested:0};return(0,a.jsx)("main",{className:"min-h-screen bg-[#020617] text-slate-50 p-4 md:p-8",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto space-y-8",children:[(0,a.jsxs)("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 border-b border-slate-800 pb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(n.Z,{className:"w-6 h-6 text-indigo-500"}),(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-white to-slate-400 bg-clip-text text-transparent",children:"Bloom Keeper"})]}),(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Delta-Neutral Funding Arbitrage Engine"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,a.jsxs)("button",{onClick:k,disabled:w,className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/20 text-sm font-semibold transition-all disabled:opacity-50",children:[(0,a.jsx)(r.Z,{className:"w-4 h-4"}),"Reset APY"]}),(0,a.jsxs)("button",{onClick:F,className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-semibold shadow-lg shadow-indigo-500/20 transition-all",children:[(0,a.jsx)(i.Z,{className:g("w-4 h-4",p&&"animate-spin")}),"Refresh"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsx)(v,{title:"Realized APY",value:"".concat(P.realized.toFixed(2),"%"),subValue:"Based on historical funding",trend:P.realized>=0?"up":"down"}),(0,a.jsx)(v,{title:"Estimated APY",value:"".concat(P.estimated.toFixed(2),"%"),subValue:"Projected forward",trend:P.estimated>=0?"up":"down"}),(0,a.jsx)(v,{title:"Next 1h Return",value:"$".concat((P.expectedEarningsNextPeriod||0).toFixed(4)),subValue:"Predicted from active positions",trend:P.expectedEarningsNextPeriod>=0?"up":"down",icon:(0,a.jsx)(o.Z,{className:"w-4 h-4 text-amber-400"})}),(0,a.jsx)(v,{title:"Net Funding",value:"$".concat((P.netFunding||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})),subValue:"Total funding captured (USD)",trend:P.netFunding>=0?"up":"down",icon:(0,a.jsx)(o.Z,{className:"w-4 h-4 text-emerald-400"})}),(0,a.jsx)(v,{title:"Realized PnL",value:"$".concat((P.realizedPnl||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})),subValue:"Total profit/loss from trades",trend:P.realizedPnl>=0?"up":"down"}),(0,a.jsx)(v,{title:"Current NAV",value:"$".concat(D.totalValue.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})),subValue:"Unrealized: ".concat(D.unrealizedPnl>=0?"+":"","$").concat(D.unrealizedPnl.toFixed(4)),trend:D.unrealizedPnl>=0?"up":"down"}),(0,a.jsx)(v,{title:"Accrued Profits",value:"$".concat(S.accruedProfits.toFixed(2)),subValue:"Total Harvested: $".concat(S.totalHarvested.toFixed(2)),icon:(0,a.jsx)(o.Z,{className:"w-4 h-4 text-amber-400"})}),(0,a.jsx)(v,{title:"Total Volume",value:"$".concat((P.totalVolume||0).toLocaleString(void 0,{maximumFractionDigits:0})),subValue:"Cumulative trade volume",icon:(0,a.jsx)(r.Z,{className:"w-4 h-4 text-indigo-400"})}),(0,a.jsx)(v,{title:"Max Drawdown",value:"".concat((P.maxDrawdown||0).toFixed(2),"%"),subValue:"Peak-to-trough decline",trend:"down",icon:(0,a.jsx)(d.Z,{className:"w-4 h-4 text-red-400"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-xl p-6 shadow-sm",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold mb-6 flex items-center gap-2",children:[(0,a.jsx)(c.Z,{className:"w-5 h-5 text-indigo-500"}),"Funding Earnings (Expected vs Actual)"]}),(0,a.jsx)("div",{className:"h-[300px] w-full",children:(0,a.jsx)(y,{data:P.historicalEarnings})})]}),(0,a.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-xl overflow-hidden shadow-sm",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-slate-800 flex justify-between items-center bg-slate-900/80",children:[(0,a.jsxs)("h2",{className:"font-semibold flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4 text-green-500"}),"Active Exchange Exposure"]}),(0,a.jsxs)("span",{className:"text-xs text-slate-500",children:[D.count," Total Legs"]})]}),(0,a.jsx)("div",{className:"p-0 overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,a.jsx)("thead",{className:"bg-slate-950/50 text-slate-400 font-medium",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3",children:"Exchange"}),(0,a.jsx)("th",{className:"px-4 py-3",children:"Symbol"}),(0,a.jsx)("th",{className:"px-4 py-3",children:"Size"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right",children:"Value (USD)"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-slate-800",children:(null==u?void 0:null===(e=u.positions)||void 0===e?void 0:e.activePositions)&&u.positions.activePositions.length>0?u.positions.activePositions.map((e,t)=>(0,a.jsxs)("tr",{className:"hover:bg-slate-800/30 transition-colors",children:[(0,a.jsx)("td",{className:"px-4 py-4",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded-md bg-indigo-500/10 text-indigo-400 font-bold text-[10px] uppercase border border-indigo-500/20",children:e.exchange})}),(0,a.jsx)("td",{className:"px-4 py-4 text-slate-300 font-medium",children:e.symbol}),(0,a.jsxs)("td",{className:g("px-4 py-4 font-mono text-xs","LONG"===e.side?"text-green-400":"text-red-400"),children:[e.side," ",Math.abs(e.size).toLocaleString(void 0,{maximumFractionDigits:4})]}),(0,a.jsxs)("td",{className:"px-4 py-4 text-right font-mono font-bold",children:["$",e.value.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]},"".concat(e.exchange,"-").concat(e.symbol,"-").concat(t))):Object.keys(D.byExchange).length>0?Object.keys(D.byExchange).map(e=>(0,a.jsxs)("tr",{className:"hover:bg-slate-800/30 transition-colors",children:[(0,a.jsx)("td",{className:"px-4 py-4",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded-md bg-indigo-500/10 text-indigo-400 font-bold text-xs uppercase border border-indigo-500/20",children:e})}),(0,a.jsx)("td",{className:"px-4 py-4 text-slate-300 font-medium",children:"Aggregate"}),(0,a.jsx)("td",{className:"px-4 py-4 text-slate-400",children:"---"}),(0,a.jsxs)("td",{className:"px-4 py-4 text-right font-mono font-bold",children:["$",D.byExchange[e].toLocaleString(void 0,{minimumFractionDigits:2})]})]},e)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,className:"px-4 py-8 text-center text-slate-500 italic",children:"No active positions detected."})})})]})})]}),(0,a.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-xl p-4 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4",children:"Funding Capture by Exchange"}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:Object.keys(P.byExchange).map(e=>(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-slate-950 border border-slate-800",children:[(0,a.jsx)("p",{className:"text-xs text-slate-500 mb-1 font-bold uppercase",children:e}),(0,a.jsxs)("p",{className:g("text-xl font-bold font-mono",P.byExchange[e]>=0?"text-green-400":"text-red-400"),children:[P.byExchange[e].toFixed(2),"% ",(0,a.jsx)("span",{className:"text-[10px] text-slate-600",children:"APY"})]})]},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-xl p-5 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-300",children:"System Integrity"}),(0,a.jsxs)("div",{className:g("px-3 py-1 rounded-full text-xs font-bold uppercase border flex items-center gap-1.5","OK"===L.overall?"bg-green-500/10 text-green-400 border-green-500/20":"bg-red-500/10 text-red-400 border-red-500/20"),children:[(0,a.jsx)("div",{className:g("w-2 h-2 rounded-full","OK"===L.overall?"bg-green-500":"bg-red-500")}),L.overall]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-800/50",children:[(0,a.jsx)("span",{className:"text-sm text-slate-400",children:"Connection HL"}),(0,a.jsxs)("span",{className:"text-sm font-semibold text-green-400 flex items-center gap-1",children:[(0,a.jsx)(x.Z,{className:"w-3.5 h-3.5"})," Live"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-800/50",children:[(0,a.jsx)("span",{className:"text-sm text-slate-400",children:"Connection Lighter"}),(0,a.jsxs)("span",{className:"text-sm font-semibold text-green-400 flex items-center gap-1",children:[(0,a.jsx)(x.Z,{className:"w-3.5 h-3.5"})," Live"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-800/50",children:[(0,a.jsx)("span",{className:"text-sm text-slate-400",children:"Global Lock"}),(0,a.jsx)("span",{className:"text-sm text-slate-500 font-mono",children:"IDLE"})]})]})]}),(0,a.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-xl p-5 shadow-sm overflow-hidden flex flex-col max-h-[400px]",children:[(0,a.jsxs)("h3",{className:"font-semibold text-slate-300 mb-4 flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 text-red-400"}),"Live Error Log"]}),(0,a.jsx)("div",{className:"space-y-3 overflow-y-auto pr-2 custom-scrollbar",children:(null==u?void 0:null===(t=u.errors)||void 0===t?void 0:t.recent)&&u.errors.recent.length>0?u.errors.recent.slice(0,10).map((e,t)=>(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-red-500/5 border border-red-500/10 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{className:"font-bold text-red-400",children:e.type}),(0,a.jsx)("span",{className:"text-slate-500 font-mono",children:e.time})]}),(0,a.jsx)("p",{className:"text-slate-400 leading-relaxed line-clamp-2",children:e.msg})]},t)):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-10 opacity-30",children:[(0,a.jsx)(m.Z,{className:"w-8 h-8 mb-2"}),(0,a.jsx)("p",{className:"text-sm italic",children:"No recent anomalies detected."})]})})]})]})]}),(0,a.jsx)("footer",{className:"text-center text-slate-600 text-xs pt-8 border-t border-slate-900",children:(0,a.jsxs)("p",{children:["\xa9 2025 Bloom Finance • Running at ",j.split("/")[2]," • Latency: ",null==u?void 0:null===(s=u.uptime)||void 0===s?void 0:s.hours.toFixed(1),"h runtime"]})})]})})}function v(e){let{title:t,value:s,subValue:l,trend:i,icon:n}=e;return(0,a.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-xl p-5 shadow-sm hover:border-slate-700 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"text-sm text-slate-400 font-medium",children:t}),n||("up"===i?(0,a.jsx)(c.Z,{className:"w-4 h-4 text-green-400"}):(0,a.jsx)(u.Z,{className:"w-4 h-4 text-red-400"}))]}),(0,a.jsx)("p",{className:g("text-2xl font-bold font-mono tracking-tight","up"===i?"text-green-400":"down"===i?"text-red-400":"text-slate-100"),children:s}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:l})]})}function y(e){let{data:t}=e;if(!t||0===t.length)return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-slate-600 italic",children:[(0,a.jsx)(c.Z,{className:"w-12 h-12 mb-2 opacity-10"}),(0,a.jsx)("p",{children:"Awaiting sufficient historical data..."})]});let s={labels:t.map(e=>new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),datasets:[{label:"Actual Earnings",data:t.map(e=>e.actual),borderColor:"#10b981",backgroundColor:"rgba(16, 185, 129, 0.1)",borderWidth:2,tension:.4,fill:!0,pointRadius:3,pointHoverRadius:5},{label:"Expected Earnings",data:t.map(e=>e.expected),borderColor:"#f59e0b",backgroundColor:"transparent",borderWidth:2,tension:.4,fill:!1,pointRadius:0,pointHoverRadius:5}]};return(0,a.jsx)(f.x1,{data:s,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",align:"end",labels:{color:"#94a3b8",boxWidth:12,font:{size:11,weight:"bold"},padding:20}},tooltip:{backgroundColor:"#0f172a",titleColor:"#f8fafc",bodyColor:"#cbd5e1",borderColor:"#1e293b",borderWidth:1,padding:12,callbacks:{label:function(e){let t=e.dataset.label||"";return t&&(t+=": "),null!==e.parsed.y&&(t+=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:4}).format(e.parsed.y)),t}}}},scales:{x:{grid:{display:!1},ticks:{color:"#64748b",font:{size:10},maxRotation:0,autoSkip:!0,maxTicksLimit:8}},y:{grid:{color:"#1e293b"},ticks:{color:"#64748b",font:{size:10},callback:function(e){return"$"+e.toFixed(2)}}}}}})}}},function(e){e.O(0,[674,537,971,23,744],function(){return e(e.s=4800)}),_N_E=e.O()}]);